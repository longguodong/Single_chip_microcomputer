C51 COMPILER V9.01   KEYBORD                                                               11/29/2017 13:04:53 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE KEYBORD
OBJECT MODULE PLACED IN keybord.OBJ
COMPILER INVOKED BY: D:\专业软件安装\keil\C51\BIN\C51.EXE keybord.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <reg51.h>
   2          #include "delay.h"
   3          #include "keybord.h"
   4          #include "ds1302.h"
   5          //sbit KEY4=P3^3;
   6          //sbit KEY5=P3^2;
   7          sbit KEY6=P3^1;
   8          sbit KEY7=P3^0;     
   9          int s=0,h=0,m=0;
  10          int d=0,mo=0,y=0;         
  11                  
  12          unsigned char key1()  //秒钟加减
  13           {      
  14   1       //加时间 
  15   1       if(KEY6==0)
  16   1              {
  17   2             Delay1ms(20);
  18   2                 while(KEY6==0)
  19   2                {
  20   3                   while(KEY6==0);
  21   3                       s++;
  22   3                       if(s==60)
  23   3                       s=0; 
  24   3                 }
  25   2               }
  26   1      
  27   1       if(KEY7==0)
  28   1              {
  29   2                //减时间
  30   2             Delay1ms(20);
  31   2                 while(KEY7==0)
  32   2                {
  33   3                   while(KEY7==0);
  34   3                       s--;
  35   3                       if(s<0)
  36   3                       s=59; 
  37   3                 }
  38   2               }
  39   1      
  40   1               
  41   1          return s; 
  42   1       }
  43          
  44          
  45           unsigned char key2()  //分钟加减
  46           {      
  47   1       //加时间 
  48   1        if(KEY6==0)
  49   1              {
  50   2             Delay1ms(20);
  51   2                 while(KEY6==0)
  52   2                {
  53   3                   while(KEY6==0);
  54   3                       m++;
  55   3                       if(m==60)
C51 COMPILER V9.01   KEYBORD                                                               11/29/2017 13:04:53 PAGE 2   

  56   3                       m=0; 
  57   3                 }
  58   2               }
  59   1      
  60   1        if(KEY7==0)
  61   1              {
  62   2                //减时间
  63   2             Delay1ms(20);
  64   2                 while(KEY7==0)
  65   2                {
  66   3                   while(KEY7==0);
  67   3                       m--;
  68   3                       if(m<0)
  69   3                       m=59; 
  70   3                 }
  71   2               }
  72   1      
  73   1               
  74   1          return m; 
  75   1      }
  76          
  77          
  78          
  79          
  80           unsigned char key3() //小时加减
  81           {      
  82   1       //加时间 
  83   1        if(KEY6==0)
  84   1              {
  85   2             Delay1ms(20);
  86   2                 while(KEY6==0)
  87   2                {
  88   3                   while(KEY6==0);
  89   3                       h++;
  90   3                       if(h==24)
  91   3                       h=0; 
  92   3                 }
  93   2               }
  94   1      
  95   1        if(KEY7==0)
  96   1              {
  97   2                //减时间
  98   2             Delay1ms(20);
  99   2                 while(KEY7==0)
 100   2                {
 101   3                   while(KEY7==0);
 102   3                       h--;
 103   3                       if(h<0)
 104   3                       h=23; 
 105   3                 }
 106   2               }
 107   1      
 108   1               
 109   1          return h; 
 110   1       }
 111          
 112          
 113          
 114           unsigned char key4() //日加减
 115           {      
 116   1       //加时间 
 117   1        if(KEY6==0)
C51 COMPILER V9.01   KEYBORD                                                               11/29/2017 13:04:53 PAGE 3   

 118   1              {
 119   2             Delay1ms(20);
 120   2                 while(KEY6==0)
 121   2                {
 122   3                   while(KEY6==0);
 123   3                       d++;
 124   3                       if(d==32)
 125   3                       d=0; 
 126   3                 }
 127   2               }
 128   1      
 129   1        if(KEY7==0)
 130   1              {
 131   2                //减时间
 132   2             Delay1ms(20);
 133   2                 while(KEY7==0)
 134   2                {
 135   3                   while(KEY7==0);
 136   3                       d--;
 137   3                       if(d<0)
 138   3                       d=31; 
 139   3                 }
 140   2               }
 141   1      
 142   1               
 143   1          return d; 
 144   1       }
 145          
 146          
 147          unsigned char key5() //月加减
 148           {      
 149   1       //加时间 
 150   1        if(KEY6==0)
 151   1              {
 152   2             Delay1ms(20);
 153   2                 while(KEY6==0)
 154   2                {
 155   3                   while(KEY6==0);
 156   3                       mo++;
 157   3                       if(mo==13)
 158   3                       mo=0; 
 159   3                 }
 160   2               }
 161   1      
 162   1        if(KEY7==0)
 163   1              {
 164   2                //减时间
 165   2             Delay1ms(20);
 166   2                 while(KEY7==0)
 167   2                {
 168   3                   while(KEY7==0);
 169   3                       mo--;
 170   3                       if(mo<0)
 171   3                       mo=12; 
 172   3                 }
 173   2               }
 174   1      
 175   1               
 176   1          return mo; 
 177   1      }
 178          
 179          
C51 COMPILER V9.01   KEYBORD                                                               11/29/2017 13:04:53 PAGE 4   

 180          unsigned char key6() //年加减
 181           {      
 182   1       //加时间 
 183   1        if(KEY6==0)
 184   1              {
 185   2             Delay1ms(20);
 186   2                 while(KEY6==0)
 187   2                {
 188   3                   while(KEY6==0);
 189   3                       y++;
 190   3                       if(y==51)
 191   3                       y=0; 
 192   3                 }
 193   2               }
 194   1      
 195   1        if(KEY7==0)
 196   1              {
 197   2                //减时间
 198   2             Delay1ms(20);
 199   2                 while(KEY7==0)
 200   2                {
 201   3                   while(KEY7==0);
 202   3                       y--;
 203   3                       if(y<0)
 204   3                       y=49; 
 205   3                 }
 206   2               }
 207   1      
 208   1               
 209   1          return y; 
 210   1      }
 211          //struct Time
 212          //{
 213          //   unsigned char second;
 214          //   unsigned char minute;
 215          //   unsigned char hour;
 216          //   unsigned char day;
 217          //   unsigned char month;
 218          //   unsigned char year;
 219          //}  ctime;


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    480    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     12    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
